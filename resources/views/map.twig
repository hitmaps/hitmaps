<html>
<head>
    <title>{{ model.mission }}/{{ model.locationNameOne }} | HITMAN Maps</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
          integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
          crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
            integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
            crossorigin=""></script>
    <script
            src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>
    <style>
        #map {
            z-index: 0;
            position: fixed;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
        }

        .leaflet-container {
            background: #464646;
        }

        .leaflet-control-zoom-in {
            border: 2px solid #fff !important;
            margin-bottom: 10px;
        }

        .leaflet-control-zoom-out {
            border: 2px solid #fff!important;
        }

        .leaflet-control-zoom-in, .leaflet-control-zoom-out {
            /*float: left!important;*/
            border-radius: 3px !important;
            padding: 5px!important;
            background: rgba(22,24,29,0.75)!important;
            color: #fff!important;
            box-shadow: none!important;
        }

        .sidebar {
            position: relative;
            float: left;
            width: 400px;
            min-height: 100vh;
            background: rgba(13,14,15,0.95);
            z-index: 1;
        }
    </style>
</head>
<body>
<div id="sidebar" class="sidebar">
    Hiiiiii
</div>
<div id="map"></div>
<script>
    var map = L.map('map', {
        maxZoom: 5,
        minZoom: 3,
        crs: L.CRS.Simple
    }).setView([{{ model.mapCenterLatitude }}, {{ model.mapCenterLongitude }}], 3);
    map.zoomControl.setPosition('topright');

    L.tileLayer('/maps/{{ model.mapFolderName }}/tiles/{z}/{x}/{y}.png', {
        attribution: 'Map data &copy; IOI Interactive',
        maxZoom: 5
    }).addTo(map);

    map.addEventListener('click', function(e) {
        alert(e.latlng.lat + ", " + e.latlng.lng);
    });

    $.ajax({
        url: '/api/nodes?missionId={{ model.missionId }}&difficulty={{ model.difficulty }}',
        method: 'GET',
        success: function(data) {
            json = JSON.parse(data);
            console.log(json);

            for (var i in json) {
                L.marker([json[i].latitude, json[i].longitude]).bindPopup("I'm a thing!").addTo(map);
            }
        },
        error: function() {
            alert('An error occurred when trying to get map nodes');
        }
    })
</script>
</body>
</html>